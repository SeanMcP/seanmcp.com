---
import { getCollection } from "astro:content";
import { slugify, sortCollection } from "src/utils";

const { series } = Astro.props;

let items;

if (series) {
  items = sortCollection
    .articles(await getCollection("articles"))
    .filter((article) => {
      return article.data.series === series;
    })
    .reverse();
}
---

{
  items && (
    <section id="series">
      <p>
        This article is part of a series titled{" "}
        <a href={`/series#${slugify(series)}`}>{series}</a>. You can read the
        other items in there series here:
      </p>
      <ol>
        {items.map((article) => {
          return (
            <li>
              <a
                href={article.url}
                aria-current={article.url === Astro.url.pathname}
              >
                {article.frontmatter.title}
              </a>
            </li>
          );
        })}
      </ol>
    </section>
  )
}

<style>
  #series {
    border: 2px solid var(--off-background);
    margin-bottom: 2rem;
    padding: 0 1rem;
  }

  #series :global([aria-current]) {
    font-weight: bold;
  }
</style>
